# mega.itmo - описание работы по кейсу "Сборка генома бактерии"
_Авторы: Станислав Сергеенков, Евгений Федоров, Иван Углов_

## Общая концепция решения
Мы разбили решение на несколько относительно простых подэтапов:

0. Осознание сущности бытия
_предположим, что некий патогенный организм - это биктерия или вирус (как наиболее вероятные варианты): таком случае их геном будет сравнительно небольшим и при этом достаточно простым для анализа._
1. Сборка
   - для _de novo_ сборки генома выбрали SPAdes как наиболее эффективный программный алгоритм, позволяющий собирать небольшие геномы.
2. Идентификация организма
   - С применением Core nucleotide database (core nt). Для досутпа к базе данных, в силу ограничений веб-версии BLAST NCBI в 1 мегабаз, использовался онлайн сервис BV-BRC.
   - Повторное выравнивание на референсный геном выполнялось посредством NCBI BLAST для уточнения процента идентичности выровненной последовательности референсному геному.
3. Поиск факторов патогенности
   - 
##Первая попытка
**Сборка**
[Выходные данные](first_attempt_at_genome_assembly)
**Выравнивание и поиск совпадений**

**Осознание своих ошибок - путь к истине**
В результате анализа получены результаты, которые не соответствовали исходному предположению, что в образце присутствует только один микроорганизм. ПОдобные результаты можно получить в различных обстоятельствах:
*Наличие мобильных генетических элементов или горизонтально перенесенных генов
*Контаминация на этапе сборки (в файле присутствуют некорректные риды, относящиеся к другим образцам)
*Контаминация на этапе секвенирования, выделения или очистки ДНК
*Высококонсервативные гены
*Слишком короткая последовательность

##Вторая попытка
**Сборка**
Предварительно выполнено триммирование для удаления низкокачественных участков и технических артефактов из прочтений (reads) с целью повышения точности и надежности всех последующих анализов посредством программного пакета [fastp](https://github.com/OpenGene/fastp) посредством следующего скрипта:
```
./fastp -i pe_1.fastq -I pe_2.fastq -o trimmed_R1.fastq -O trimmed_R2.fastq --detect_adapter_for_pe -q 10 -u 30 -l 50 --html fastp_report.html --json fastp_report.json
```
[Выходные данные выполнения триммирования](https://web-projects.kvnel.ru/ivan/trimmed/fastp_report.html)

[Триммированное прямое чтение](https://web-projects.kvnel.ru/ivan/trimmed/trimmed_R1.fastq)

[Триммированное обратное чтение](https://web-projects.kvnel.ru/ivan/trimmed/trimmed_R2.fastq)

Сборка производилась аналогично первой попытке: посредством SPAdes:
```
spades.py --isolate -1 pe_1.fastq -2 pe_2.fastq -o spades_output -t 16 -m 32
```
[Выходные данные сборки](second_attempt_at_genome_assembly)


