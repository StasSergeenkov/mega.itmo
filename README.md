# mega.itmo - описание работы по кейсу "Сборка генома бактерии"
_Авторы: Станислав Сергеенков, Евгений Федоров, Иван Углов_

## Общая концепция решения
Решение было разбито на несколько относительно простых этапов:

0. **Постановка задачи и анализ возможных сценариев**
   Предполагалось, что патогенный организм в образце является бактерией (по условию задачи). В этом случае его геном должен быть относительно небольшим и достаточно простым для анализа.

1. **Сборка генома**
   Для _de novo_ сборки генома был выбран SPAdes как эффективный инструмент, хорошо подходящий для сборки небольших геномов.

2. **Идентификация организма**
   * Для первичной идентификации использовалась Core Nucleotide Database (core nt). В связи с ограничением веб-версии BLAST NCBI в 1 мегабазу, доступ к базе данных осуществлялся через онлайн-сервис BV-BRC.
   * Для уточнения процента идентичности последовательности выравнивание на референсный геном проводилось с помощью NCBI BLAST.

3. **Поиск факторов патогенности**
   В качестве основного источника информации о факторах патогенности была выбрана база данных VFDB (Virulence Factors Database).

## Первая попытка

### Сборка
Сборка выполнялась с помощью SPAdes. Команда для запуска:
```bash
spades.py --isolate -1 pe_1.fastq -2 pe_2.fastq -o spades_output -t 16 -m 32
```
[Выходные данные сборки](first_attempt_at_genome_assembly)

### Выравнивание и поиск совпадений
Поиск в BLAST выявил множество нерелевантных совпадений: с полными геномами _Clostridium botulinum B str. Eklund 17B_, _Salmonella enterica subsp. enterica serovar Typhi str. CT18_ и других штаммов.
[Результаты выравнивания](ncbi_blast_first_alignment/first_alignment_of_the_assembly_BEFORE_TRIMMED.csv)

### Анализ ошибок и корректировка подхода
Полученные результаты не соответствовали исходному предположению о присутствии в образце лишь одного микроорганизма. Возможные причины таких результатов:
* Наличие мобильных генетических элементов или горизонтальный перенос генов (однако это не дало бы 100% совпадения по полному геному).
* Контаминация на этапе подготовки библиотеки или секвенирования (вероятная причина).
* Контаминация на этапе выделения или очистки ДНК (вероятная причина).
* Наличие высококонсервативных генов (также не объясняет 100% совпадения по полному геному).
* Слишком короткие последовательности (неприменимо, так как работа велась с данными полногеномного секвенирования).

## Вторая попытка

### Предобработка данных и сборка
Для повышения качества данных было выполнено триммирование ридов с целью удаления низкокачественных участков и технических артефактов. Обработка проводилась с помощью программы fastp:
```bash
./fastp -i pe_1.fastq -I pe_2.fastq -o trimmed_R1.fastq -O trimmed_R2.fastq --detect_adapter_for_pe -q 10 -u 30 -l 50 --html fastp_report.html --json fastp_report.json
```
[Отчет о триммировании](https://web-projects.kvnel.ru/ivan/trimmed/fastp_report.html)  
[Триммированные прямые чтения](https://web-projects.kvnel.ru/ivan/trimmed/trimmed_R1.fastq)  
[Триммированные обратные чтения](https://web-projects.kvnel.ru/ivan/trimmed/trimmed_R2.fastq)

Затем была выполнена повторная сборка с использованием SPAdes с теми же параметрами:
```bash
spades.py --isolate -1 trimmed_R1.fastq -2 trimmed_R2.fastq -o spades_output_trimmed -t 16 -m 32
```
[Выходные данные сборки](second_attempt_at_genome_assembly)

### Выравнивание и идентификация организма
После триммирования количество ложных совпадений уменьшилось, однако результаты по-прежнему указывали на соответствие фрагментов генома разным организмам. Для проверки гипотезы о принадлежности генома к одному микроорганизму было выполнено выравнивание на референсный геном _Clostridium botulinum B str. Eklund 17B_. Процент идентичности составил >98%, что подтвердило принадлежность собранного генома к данному штамму.
[Результаты выравнивания на референс](ncbi_blast_second_alignment/RST6ZZB2114-Alignment-HitTable.csv)

### Аннотация и поиск факторов патогенности
Собранный геном был аннотирован с помощью NCBI Prokaryotic Genome Annotation Pipeline (PGAP):
```bash
sudo ./pgap.py -r -o trimmed_annotation -g scaffolds.fasta -s 'Clostridium botulinum' --ignore-all-errors
```
[Результаты аннотации](annotation)

Для поиска факторов патогенности аннотированные гены были сопоставлены с базой данных VFDB. В результате было обнаружено 4 потенциальных факторов патогенности.
[Таблица с найденными генами патогенности](search_for_pathogenicity_factors/pathogenic_gene.tsv)

## Описание идентифицированного микроорганизма _Clostridium botulinum B str. Eklund 17B_
Обнаруженный штамм является эталонным изолятом. Он был выделен и охарактеризован Карлом Эклундом в 1960-х годах в лабораториях США (в частности, связан с исследованиями в области безопасности пищевых продуктов и вакцин).
Он был выделен из природного источника (предположительно, из почвы или испорченных пищевых продуктов).
Этот штамм относится к протеолитической группе C. botulinum. Он способен расщеплять белки (то есть проявляет протеолитическую активность), что влияет на характеристики токсина и среду, в которой он может расти.

Обнаруженный штамм продуцирует чистый токсин типа B, без продукции других типов ботулотоксина (A, C, D и т.д.), что делает его ценным для получения специфического токсина для исследований и производства.
В проанализированном геноме нам не удалось обнаружить гены, кодирующие ботулотоксин типа B. Несмотря на то, что исследуемый образец был идентифицирован как штамм наиболее филогенетически близкий к Clostridium botulinum B str. Eklund 17B, при аннотировании генома нам удалось обнаружить ботулинический нейротоксин подтипа F6 _(pgaptmp_000640: "botulinum neurotoxin subtype F6")_, что может говорить о том, что <ins>анализируемый нами штамм</ins> вероятно является политоксигенным, относится к первой группе по геномной классификации и продуцирует проетолитические токсины групп A, B и F.
